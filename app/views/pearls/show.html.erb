<% title "Gedankenperle: " + @pearl.title %>

<% content_for :head do %>

<meta property="og:name" content="<%= @pearl.title %>"/>
<meta property="og:type" content="<%= @pearl.body %>"/>
<meta property="og:description" content="link"/>
<% if @pearl.image_url.present? %>
	<meta property="og:picture" content="<%= @pearl.image_url(:thumb).to_s %>"/>
<% end %>
<meta property="og:url" content="<%= pearl_path(@pearl) %>"/>

<% end %>

<h3><%= @pearl.title %></h3>
von <%= @pearl.user.username %> ( <%= @pearl.impressionist_count %> Mal gesehen) 
<br/>
<%= social_share_button_tag(@pearl.title, :url => pearl_path(@pearl), :image => @pearl.image_url(:thumb).to_s,  :img => @pearl.image_url(:thumb).to_s) %>	
<br/>
<br/>

<div class="container-fluid">	
	<% if @pearl.image_url.present? %>
		<a href="<%= @pearl.image_url %>">			
    		<%= image_tag(@pearl.image_url, :class => "img-responsive") %>
    	</a>
    <% end %>	        	        
    <br />
    <%= raw @pearl.body %>
    
    <br />
    
    <% @pearl.comments.each do |comment| %>
    	<% if (comment.user.present?) %>
	    	<div class="row">
	    		<div class="col-xs-3">					
			        <%= render partial: "discussions/short_user", locals: { user: comment.user} %>		        						
			    </div>		        		        		       
			    <div class="col-xs-9 nopadding">
			    	 <%= comment.comment %> 		
	    		</div>	    			
	    	</div>
    	<% end %>	    
    <% end %>
    
    <% if ((user_signed_in? && (current_user.id == @pearl.user_id)) || current_user_admin?) %>
    	<%= simple_form_for @new_comment do |f| %>
  			<%= f.association :user %>
  			<%= f.input :commentable %>
  			<%= f.input :title %>
  			<%= f.text_area :comment %>
  			<%= f.submit %>
		<% end %>
	<% end %>
        
</div>
<br/>
<% if @pearl.previous.presence %>	
<a href="<%= pearl_path(@pearl.previous) %>">		
	<button type="button" class="btn btn-default btn-xs spaced-btn">
  		<span class="glyphicon glyphicon-chevron-left"></span> Vorherige
	</button>
</a>	
<% end %>
<%= link_to 'Übersicht', pearls_path(), :class => "btn btn-info btn-xs spaced-btn" %>
<% if @pearl.next.presence %>	
<a href="<%= pearl_path(@pearl.next) %>">		
	<button type="button" class="btn btn-default btn-xs spaced-btn">
  		<span class="glyphicon glyphicon-chevron-right"></span> Nächste
	</button>
</a>	
<% end %>

<% if ((user_signed_in? && (current_user.id == @pearl.user_id)) || current_user_admin?) %>
<br/>
<br/>
<br/>			
	<div class="btn-toolbar" data-no-turbolink>		
		<%= link_to 'Ändern', edit_pearl_path(@pearl), data: { no_turbolink: true }, :class => "btn btn-warning btn-xs spaced-btn" %> 
		<%= button_to 'Löschen', @pearl, method: :delete, data: { confirm: 'Are you sure?' }, :class => "btn btn-danger btn-xs spaced-btn" %>
	</div>
<% end %>
